<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Album Foto Batari</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Abril+Fatface&family=Playfair+Display:wght@400&display=swap" rel="stylesheet">

<style>
html,body{
    margin:0;
    height:100%;
    overflow:hidden;
    background:#000;
}

/* ================= SPLASH ================= */

#startOverlay{
    position:fixed;
    inset:0;
    background:#000;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    text-align:center;
    color:white;
    z-index:100;
    transition:opacity 0.6s ease, transform 0.6s ease;
}

#startOverlay.exit{
    opacity:0;
    transform:scale(1.05);
    pointer-events:none;
}

.phone-rotate{
    width:50px;
    height:85px;
    border:2px solid white;
    border-radius:14px;
    margin-bottom:25px;
    animation:rotatePhone 8s infinite ease-in-out;
}

@keyframes rotatePhone{
    0%{ transform:rotate(0deg); }
    50%{ transform:rotate(90deg); }
    100%{ transform:rotate(0deg); }
}

.title{
    font-family:'Abril Fatface', serif;
    font-size:28px;
    margin-bottom:16px;
}

.subtitle{
    font-family:'Playfair Display', serif;
    font-weight:400;
    font-size:13px;
    line-height:1.6;
    opacity:0.85;
}

/* ================= FIREFLIES ================= */

#fireflyCanvas{
    position:fixed;
    inset:0;
    z-index:101;
    pointer-events:none;
}

/* ================= EXIT BUTTON ================= */

#exitBtn{
    position:fixed;
    top:20px;
    right:20px;
    font-size:28px;
    color:white;
    cursor:pointer;
    z-index:200;
    display:none;
}

/* ================= ALBUM ================= */

.stage{
    position:fixed;
    inset:0;
    width:100vw;
    height:100dvh; /* FIX iOS */
    display:flex;
    justify-content:center;
    align-items:center;
    background: radial-gradient(circle at center, #2e2e2e 0%, #111 100%);
}

.scale-wrapper{
    transform-origin:center center;
}

#flipbook{
    width:1308px;
    height:600px;
}

.page{
    background:white;
}

.page img{
    width:100%;
    height:100%;
    object-fit:contain;
}
</style>
</head>

<body>

<canvas id="fireflyCanvas"></canvas>

<div id="startOverlay">
    <div class="phone-rotate"></div>
    <div class="title">Album Foto</div>
    <div class="subtitle">
        Juni 2022 - Juli 2025<br>
        Perjalanan Seorang Anak Manusia<br>
        Gunakan mode landscape<br>
        Ketuk di mana saja untuk membuka
    </div>
</div>

<div id="exitBtn">âœ•</div>

<div class="stage">
    <div class="scale-wrapper">
        <div id="flipbook"></div>
    </div>
</div>

<script src="page-flip.browser.js"></script>

<script>
/* ================= FIREFLIES ================= */

const canvas = document.getElementById("fireflyCanvas");
const ctx = canvas.getContext("2d");

let w,h;
let speedMultiplier = 1;

function resize(){
    w = canvas.width = window.innerWidth;
    h = canvas.height = window.innerHeight;
}
resize();
window.addEventListener("resize",resize);

class Firefly{
    constructor(){ this.reset(); }
    reset(){
        this.size = Math.random()*6+6;
        this.side = Math.floor(Math.random()*4);

        if(this.side===0){ this.x=-20; this.y=Math.random()*h; }
        if(this.side===1){ this.x=w+20; this.y=Math.random()*h; }
        if(this.side===2){ this.x=Math.random()*w; this.y=-20; }
        if(this.side===3){ this.x=Math.random()*w; this.y=h+20; }

        this.vx=(Math.random()-0.5)*0.7;
        this.vy=(Math.random()-0.5)*0.7;
    }
    update(){
        this.x+=this.vx*speedMultiplier;
        this.y+=this.vy*speedMultiplier;

        if(this.x<-40||this.x>w+40||this.y<-40||this.y>h+40){
            this.reset();
        }
    }
    draw(){
        ctx.beginPath();
        ctx.arc(this.x,this.y,this.size,0,Math.PI*2);
        ctx.fillStyle="rgba(255,215,90,0.95)";
        ctx.shadowColor="rgba(255,215,90,0.8)";
        ctx.shadowBlur=25;
        ctx.fill();
    }
}

const fireflies=[];
for(let i=0;i<5;i++){
    fireflies.push(new Firefly());
}

function animate(){
    ctx.clearRect(0,0,w,h);
    fireflies.forEach(f=>{
        f.update();
        f.draw();
    });
    requestAnimationFrame(animate);
}
animate();

/* ================= SPLASH ================= */

const overlay=document.getElementById("startOverlay");
const exitBtn=document.getElementById("exitBtn");

overlay.addEventListener("click",()=>{
    speedMultiplier=4;
    overlay.classList.add("exit");

    setTimeout(()=>{
        overlay.style.display="none";
        canvas.style.display="none";
        exitBtn.style.display="block";
    },600);
});

exitBtn.addEventListener("click",()=>{
    location.reload();
});

/* ================= ALBUM ================= */

const flipbook=document.getElementById("flipbook");
const wrapper=document.querySelector(".scale-wrapper");

for(let i=1;i<=80;i++){
    const page=document.createElement("div");
    page.classList.add("page");
    const img=document.createElement("img");
    img.src="images/"+i+".jpg";
    page.appendChild(img);
    flipbook.appendChild(page);
}

const pageFlip=new St.PageFlip(flipbook,{
    width:654,
    height:600,
    size:"fixed",
    showCover:true,
    usePortrait:false
});

pageFlip.loadFromHTML(document.querySelectorAll(".page"));

function scaleBook(){
    const scaleX=window.innerWidth/1308;
    const scaleY=window.innerHeight/600;
    wrapper.style.transform=`scale(${Math.min(scaleX,scaleY)*0.95})`;
}
window.addEventListener("resize",scaleBook);
scaleBook();
</script>

</body>
</html>
